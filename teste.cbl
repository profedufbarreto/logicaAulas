IDENTIFICATION DIVISION.
PROGRAM-ID. SISTEMA-BANCARIO.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-SALDO           PIC 9(7)V99 VALUE 500.00.
01 WS-VALOR-AUX       PIC 9(7)V99.
01 WS-OPCAO           PIC 9.
01 WS-MENSAGEM-ERRO   PIC X(30).

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    PERFORM UNTIL WS-OPCAO = 4
        DISPLAY " "
        DISPLAY "--- MENU BANCARIO COBOL ---"
        DISPLAY "1 - VER SALDO"
        DISPLAY "2 - DEPOSITAR"
        DISPLAY "3 - SACAR"
        DISPLAY "4 - SAIR"
        DISPLAY "ESCOLHA UMA OPCAO: "
        ACCEPT WS-OPCAO

        EVALUATE WS-OPCAO
            WHEN 1
                PERFORM EXIBIR-SALDO
            WHEN 2
                DISPLAY "DIGITE O VALOR PARA DEPOSITO: "
                ACCEPT WS-VALOR-AUX
                PERFORM DEPOSITAR
            WHEN 3
                DISPLAY "DIGITE O VALOR PARA SAQUE: "
                ACCEPT WS-VALOR-AUX
                PERFORM SACAR
            WHEN 4
                DISPLAY "ENCERRANDO SISTEMA..."
            WHEN OTHER
                DISPLAY "OPCAO INVALIDA!"
        END-EVALUATE
    END-PERFORM.
    STOP RUN.

EXIBIR-SALDO.
    DISPLAY "================================"
    DISPLAY "SALDO ATUAL: R$ " WS-SALDO
    DISPLAY "================================".

DEPOSITAR.
    IF WS-VALOR-AUX > 0 THEN
        ADD WS-VALOR-AUX TO WS-SALDO
        DISPLAY "DEPOSITO REALIZADO COM SUCESSO!"
    ELSE
        DISPLAY "VALOR INVALIDO!"
    END-IF.

SACAR.
    IF WS-VALOR-AUX > 0 AND WS-VALOR-AUX <= WS-SALDO THEN
        SUBTRACT WS-VALOR-AUX FROM WS-SALDO
        DISPLAY "SAQUE EFETUADO!"
    ELSE
        DISPLAY "ERRO: SALDO INSUFICIENTE!"
    END-IF.